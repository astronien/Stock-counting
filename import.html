<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Stock - Stock Counting System</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Stock ‡∏à‡∏≤‡∏Å CSV/Excel">
    <meta name="theme-color" content="#667eea">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <!-- SheetJS for Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <!-- Background Gradient -->
    <div class="bg-gradient"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="title">
                    <span class="icon">üì§</span>
                    Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Stock
                </h1>
                <p class="subtitle">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV ‡∏´‡∏£‡∏∑‡∏≠ Excel</p>
                <a href="index.html" class="back-link">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            </div>
        </header>

        <!-- Upload Section -->
        <div class="card">
            <div class="card-header">
                <h3>üìÅ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</h3>
            </div>
            <div class="card-body">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">üìÇ</div>
                    <p class="upload-text">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á</p>
                    <p class="upload-hint">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: CSV, XLSX, XLS</p>
                    <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        <span class="btn-icon">üìÅ</span>
                        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
                    </button>
                </div>

                <div id="fileInfo" class="file-info" style="display: none;">
                    <p><strong>‡πÑ‡∏ü‡∏•‡πå:</strong> <span id="fileName"></span></p>
                    <p><strong>‡∏Ç‡∏ô‡∏≤‡∏î:</strong> <span id="fileSize"></span></p>
                    <p><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> <span id="fileType"></span></p>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="card" id="previewSection" style="display: none;">
            <div class="card-header">
                <h3>üëÅÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                    ‡πÅ‡∏™‡∏î‡∏á 10 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å
                </p>
            </div>
            <div class="card-body">
                <div class="table-container" style="max-height: 400px;">
                    <table id="previewTable">
                        <thead id="previewHead"></thead>
                        <tbody id="previewBody"></tbody>
                    </table>
                </div>

                <div class="import-stats">
                    <div class="stat-item">
                        <span class="stat-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                        <span class="stat-value" id="totalRows">0</span>
                        <span class="stat-unit">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Columns:</span>
                        <span class="stat-value" id="totalColumns">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Column Mapping Section -->
        <div class="card" id="mappingSection" style="display: none;">
            <div class="card-header">
                <h3>üîó ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà Columns</h3>
                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤ column ‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∑‡∏≠ S/N ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                </p>
            </div>
            <div class="card-body">
                <div class="mapping-grid">
                    <div class="input-group">
                        <label for="snColumn">Column ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Serial Number (S/N)</label>
                        <select id="snColumn" class="form-select"></select>
                    </div>
                    <div class="input-group">
                        <label for="nameColumn">Column ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                        <select id="nameColumn" class="form-select"></select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="action-buttons" id="actionButtons" style="display: none;">
            <button class="btn btn-danger" onclick="clearData()">
                <span class="btn-icon">üóëÔ∏è</span>
                ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
            <button class="btn btn-success" onclick="importData()">
                <span class="btn-icon">üöÄ</span>
                Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </button>
        </div>

        <!-- Progress -->
        <div class="card" id="progressSection" style="display: none;">
            <div class="card-header">
                <h3>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á Import...</h3>
            </div>
            <div class="card-body">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">0 / 0</p>
            </div>
        </div>

        <!-- Messages -->
        <div id="message" class="message success"></div>
        <div id="error" class="message error"></div>

        <div class="footer">
            <p>¬© 2025 Stock Counting System | Import Data Tool</p>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
    </div>

    <!-- Import Script -->
    <script type="module" src="import-supabase.js"></script>
</body>

</html>